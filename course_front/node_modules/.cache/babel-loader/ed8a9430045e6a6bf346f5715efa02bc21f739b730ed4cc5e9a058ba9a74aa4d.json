{"ast":null,"code":"import { onMounted, ref } from \"vue\";\nimport axios from \"axios\";\nimport { message } from \"ant-design-vue\";\nexport default {\n  name: \"Curelation\",\n  setup() {\n    const curelation = ref();\n    const columns = ref([{\n      title: '编号',\n      dataIndex: 'id',\n      key: 'id'\n    }, {\n      title: '课程名称',\n      dataIndex: 'type',\n      key: \"type\"\n    }, {\n      title: '听课人员',\n      dataIndex: 'name',\n      key: 'name'\n    }, {\n      title: '操作',\n      key: 'action'\n    }]);\n\n    // 查询方法\n    const load = () => {\n      console.log(\"load \");\n      axios.get(\"api/queryCurelation\", {}).then(res => {\n        console.log(res);\n        if (res.data.code === \"200\") {\n          curelation.value = res.data.date;\n        } else {\n          message.error(res.data.msg);\n        }\n      });\n    };\n    let teacher = ref([]);\n    // 查询方法\n    const queryTeacher = () => {\n      axios.get(\"api/queryTeacher\", {}).then(res => {\n        console.log(res);\n        if (res.data.code === \"200\") {\n          teacher.value = res.data.date;\n        } else {\n          message.error(res.data.msg);\n        }\n      });\n    };\n    const course = ref([]);\n    // 查询所有课程\n    const queryCourse = () => {\n      axios.get(\"api/queryCourse\", {}).then(res => {\n        console.log(res);\n        if (res.data.code === \"200\") {\n          course.value = res.data.date;\n        } else {\n          message.error(res.data.msg);\n        }\n      });\n    };\n\n    // 听课人员\n    const getUser = userid => {\n      console.log('getUser', userid);\n      for (let i = 0; i < teacher.value.length; i++) {\n        const t = teacher.value[i];\n        if (t.id === userid) {\n          return t.name;\n        }\n      }\n    };\n    const formState = ref({});\n    const visible = ref(false); // 对话框的开关\n    const confirmLoading = ref(false); // 确认按钮的加载\n\n    // 新增的点击事件\n    const listening = () => {\n      formState.value = {}; // 清空表单数据\n      visible.value = true; // 打开对话框\n    };\n\n    // 对话框ok时会调用\n    const handleOk = () => {\n      visible.value = false;\n      axios.post(\"api/listening\", formState.value).then(res => {\n        if (res.data.code === \"200\") {\n          message.success(res.data.msg);\n          formState.value = {};\n          load();\n        } else {\n          message.error(res.data.msg);\n        }\n      });\n    };\n\n    // 删除的点击事件\n    const del = id => {\n      // 发送请求\n      axios.delete(\"api/delCurelation/\" + id).then(res => {\n        console.log(res);\n        if (res.data.code === \"200\") {\n          // 重新加载数据\n          load();\n          message.success(res.data.msg);\n        } else {\n          message.error(res.data.msg);\n        }\n      });\n    };\n    onMounted(() => {\n      load();\n      queryTeacher();\n      queryCourse();\n    });\n    return {\n      curelation,\n      columns,\n      getUser,\n      // 表单\n      labelCol: {\n        style: {\n          width: '130px'\n        }\n      },\n      wrapperCol: {\n        span: 14\n      },\n      formState,\n      visible,\n      confirmLoading,\n      listening,\n      teacher,\n      course,\n      handleOk,\n      del\n    };\n  }\n};","map":{"version":3,"mappings":"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","names":["onMounted","ref","axios","message","name","setup","curelation","columns","title","dataIndex","key","load","console","log","get","then","res","data","code","value","date","error","msg","teacher","queryTeacher","course","queryCourse","getUser","userid","i","length","t","id","formState","visible","confirmLoading","listening","handleOk","post","success","del","delete","labelCol","style","width","wrapperCol","span"],"sourceRoot":"","sources":["D:\\course\\src\\views\\Curelation.vue"],"sourcesContent":["<template>\r\n\r\n\r\n  <div  style=\"margin: 15px; width: 1000px\">\r\n\r\n\r\n    <a-button type=\"primary\" @click=\"listening\" >听课</a-button>\r\n\r\n\r\n    <a-table :dataSource=\"curelation\" :columns=\"columns\" :pagination=\"false\">\r\n      <template #bodyCell=\"{ column, record }\">\r\n\r\n        <template v-if=\"column.key === 'userid'\">\r\n           {{ getUser(record.userid) }}\r\n        </template>\r\n\r\n        <!--        操作-->\r\n        <template v-else-if=\"column.key === 'action'\">\r\n          <a-space>\r\n\r\n            <a-popconfirm\r\n                title=\"是否确认删除?\"\r\n                ok-text=\"是\"\r\n                cancel-text=\"否\"\r\n                @confirm=\"del(record.id)\"\r\n            >\r\n              <a-button type=\"primary\" danger>删除</a-button>\r\n            </a-popconfirm>\r\n          </a-space>\r\n        </template>\r\n\r\n      </template>\r\n    </a-table>\r\n  </div>\r\n\r\n\r\n  <a-modal\r\n      v-model:visible=\"visible\"\r\n      title=\"听课安排\"\r\n      :confirm-loading=\"confirmLoading\"\r\n      @ok=\"handleOk\"\r\n  >\r\n    <!--      <p> 表单 </p>-->\r\n    <a-form :model=\"formState\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\">\r\n      <a-form-item label=\"课程名称\" >\r\n        <a-select\r\n            ref=\"select\"\r\n            v-model:value=\"formState.courseid\"\r\n        >\r\n          <a-select-option v-for=\"c in course\"  :key=\"c.id\" :value=\"c.id\">\r\n            {{ c.coursename }}\r\n          </a-select-option>\r\n\r\n        </a-select>\r\n      </a-form-item>\r\n      <a-form-item label=\"听课教师\" >\r\n        <a-select\r\n            ref=\"select\"\r\n            v-model:value=\"formState.name\"\r\n        >\r\n          <a-select-option v-for=\"t in teacher\"  :key=\"t.id\" :value=\"t.name\">\r\n            {{ t.name }}\r\n          </a-select-option>\r\n\r\n        </a-select>\r\n      </a-form-item>\r\n\r\n    </a-form>\r\n\r\n  </a-modal>\r\n\r\n</template>\r\n\r\n<script>\r\nimport {onMounted, ref} from \"vue\";\r\nimport axios from \"axios\";\r\nimport {message} from \"ant-design-vue\";\r\n\r\nexport default {\r\n  name: \"Curelation\",\r\n  setup(){\r\n    const curelation = ref();\r\n\r\n    const columns = ref([\r\n      {\r\n        title: '编号',\r\n        dataIndex: 'id',\r\n        key:'id'\r\n      },\r\n      {\r\n        title: '课程名称',\r\n        dataIndex: 'type',\r\n        key:\"type\"\r\n      },\r\n      {\r\n        title: '听课人员',\r\n        dataIndex: 'name',\r\n        key:'name'\r\n      },\r\n      {\r\n        title: '操作',\r\n        key: 'action'\r\n      }\r\n\r\n    ]);\r\n\r\n    // 查询方法\r\n    const load = ()=>{\r\n      console.log(\"load \")\r\n      axios.get(\"api/queryCurelation\",{}).then(res=>{\r\n        console.log(res)\r\n        if (res.data.code === \"200\"){\r\n          curelation.value = res.data.date\r\n        }else {\r\n          message.error(res.data.msg);\r\n        }\r\n      })\r\n    }\r\n\r\n    let teacher = ref([]);\r\n    // 查询方法\r\n    const queryTeacher = ()=>{\r\n      axios.get(\"api/queryTeacher\",{}).then(res=>{\r\n        console.log(res)\r\n        if (res.data.code === \"200\"){\r\n          teacher.value = res.data.date\r\n        }else {\r\n          message.error(res.data.msg);\r\n        }\r\n      })\r\n    }\r\n\r\n    const course = ref([]);\r\n    // 查询所有课程\r\n    const queryCourse = ()=>{\r\n      axios.get(\"api/queryCourse\",{}).then(res=>{\r\n        console.log(res)\r\n        if (res.data.code === \"200\"){\r\n          course.value = res.data.date\r\n        }else {\r\n          message.error(res.data.msg);\r\n        }\r\n      })\r\n    }\r\n\r\n\r\n    // 听课人员\r\n    const getUser = (userid)=>{\r\n      console.log('getUser' , userid)\r\n      for (let i=0; i<teacher.value.length; i++){\r\n        const t = teacher.value[i];\r\n        if (t.id === userid   ){\r\n          return t.name;\r\n        }\r\n      }\r\n    }\r\n\r\n\r\n    const formState = ref({})\r\n    const visible = ref(false);  // 对话框的开关\r\n    const confirmLoading = ref(false); // 确认按钮的加载\r\n\r\n\r\n    // 新增的点击事件\r\n    const listening = () => {\r\n      formState.value = {}; // 清空表单数据\r\n      visible.value = true; // 打开对话框\r\n    };\r\n\r\n\r\n    // 对话框ok时会调用\r\n    const handleOk = () => {\r\n\r\n      visible.value = false;\r\n      axios.post(\"api/listening\",formState.value).then(res=>{\r\n        if (res.data.code === \"200\"){\r\n          message.success(res.data.msg);\r\n          formState.value = {}\r\n          load();\r\n        }else {\r\n          message.error(res.data.msg);\r\n        }\r\n      })\r\n    }\r\n\r\n    // 删除的点击事件\r\n    const del = (id) => {\r\n      // 发送请求\r\n      axios.delete(\"api/delCurelation/\" + id).then(res=>{\r\n        console.log(res)\r\n        if (res.data.code === \"200\"){\r\n          // 重新加载数据\r\n          load()\r\n          message.success(res.data.msg);\r\n        }else {\r\n          message.error(res.data.msg);\r\n        }\r\n      })\r\n    };\r\n\r\n    onMounted(()=>{\r\n      load()\r\n      queryTeacher()\r\n      queryCourse()\r\n    })\r\n\r\n\r\n    return {\r\n      curelation,\r\n      columns,\r\n      getUser,\r\n\r\n      // 表单\r\n      labelCol: { style: { width: '130px' } },\r\n      wrapperCol: { span: 14 },\r\n      formState,\r\n      visible,\r\n      confirmLoading,\r\n      listening,\r\n      teacher,\r\n      course,\r\n      handleOk,\r\n\r\n      del\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}